statement-name: "insert-internal-from-input-loop-v1"
flink-compute-pool: "CP_AZC_${environment}_PEVE_01"
stopped: "true" # true to pause, false to resume
statement: |
  insert into `${catalog_name}`.`${cluster_name}`.`cc-loc-peve-terraform-internal`(
    event_start,
    event_end,
    new_field1,
    new_field2,
    new_field3,
    new_field4
  )
  SELECT
    window_start,
    window_end,
    ( MAX(my_field1) + 1 ) AS my_field1,
    ( AVG(my_field2) + 100.0 ) AS my_field2,
    CONCAT('Interacci√≥n: ', CAST( MAX(my_field1) AS VARCHAR)) AS my_field3,
    CAST (COUNT(my_field1) AS INT) AS my_field4
  FROM TABLE (
  TUMBLE (
    TABLE `${catalog_name}`.`${cluster_name}`.`cc-loc-peve-terraform-input-loop`,
    DESCRIPTOR ($rowtime ),
    INTERVAL '1' SECONDS )
  )
  GROUP BY window_start, window_end;